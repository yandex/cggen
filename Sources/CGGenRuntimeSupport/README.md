# CGGenRuntimeSupport

This module provides runtime support for code generated by cggen, including the Drawing struct and utilities for creating images.

## Drawing Struct

The core type is `Drawing`, which encapsulates a size and draw function:

```swift
public struct Drawing {
  public let size: CGSize
  public let draw: (CGContext) -> Void
}
```

## SwiftUI Support

Drawing conforms to View, enabling direct usage in SwiftUI:

```swift
// In SwiftUI views
Drawing.circle
  .foregroundColor(.blue)
  .frame(width: 44, height: 44)
```

## Image Creation

### CGImage Creation

```swift
// Create a CGImage from a Drawing
if let cgImage = CGImage.draw(from: Drawing.star) {
  // Use cgImage...
}

// Create with custom scale
let scaledImage = CGImage.draw(
  from: Drawing.star,
  scale: 2.0
)
```

### Platform Image Creation

```swift
// UIKit (iOS/tvOS/watchOS)
#if canImport(UIKit)
let uiImage = UIImage(Drawing.circle)
let scaledImage = UIImage(Drawing.circle, scale: 3.0)
#endif

// AppKit (macOS)
#if canImport(AppKit)
let nsImage = NSImage(Drawing.square)
#endif
```

## Direct Drawing

### Drawing to CGContext

```swift
// Draw directly using the draw function
Drawing.star.draw(context)

// Or use CGContext extension
context.draw(Drawing.star, at: CGPoint(x: 10, y: 10))
```

## Usage with Generated Code

When using `cggen` with `--generation-style swift-friendly`, generated code extends the Drawing namespace:

```swift
// Generated by cggen
extension Drawing {
  static let circle = Drawing(
    size: CGSize(width: 50, height: 50),
    draw: myDrawCircleFunction
  )
  static let star = Drawing(
    size: CGSize(width: 60, height: 60),
    draw: myDrawStarFunction
  )
}

// Usage
Drawing.circle  // Access generated drawings
Drawing.star.size  // Get size information
```

## Error Handling

CGImage creation returns an optional and may fail if graphics context creation fails. Platform image initializers (UIImage/NSImage) handle failures gracefully by returning empty images.